---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# rcmip6

<!-- badges: start -->
<!-- badges: end -->

The goal of rcmip6 is to search and download data from the CMIP6 project. 

## Installation

You can install the development version of rcmip6 like so:

``` r
remotes::install_github("eliocamp/rcmip6")
```

## Example

Search models, variables, etc... using `cmip_search()`

```{r example}
library(rcmip6)

query <- list(
  type               = "Dataset",
  replica            = "false",
  latest             = "true",
  variable_id        = "tas",
  project            = "CMIP6",
  frequency          = "mon",                          
  table_id           = "Amon",
  experiment_id      = "historical",
  source_id          = "CanESM5"
)

results <- cmip_search(query)
results
```

Sumary of results:

```{r}
as.data.frame(results) |> 
  head(10) |> 
  knitr::kable()
```

The, download the data.
Just as a demonstration, download only the first result

```{r}
root <- "readme_example"
options(timeout = 360) # Kind of important for some reason

files <- cmip_download(results[1], base_dir = root)
```

The files are saved mirroring the source file structure to ensure that each file is unique. 

```{r}
cat(system(paste0("tree ", shQuote(root)), intern = TRUE), sep = "\n")
```

